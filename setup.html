<!DOCTYPE html>

<html lang="en" dir="ltr">
  <head>
        <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CGE28W6H33"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-CGE28W6H33');
    </script>
    <meta charset="utf-8">
    <title>Square Off</title>
    <link rel="stylesheet" href="styles/setup.css">
    <link rel="icon" href="./styles/icon/icon.png">
  </head>

  <body>
    
    <div class="main">

      <div class="header">
  
        <a href="index.html">
            <h1 class = "title">GAME SETTINGS</h1>
        </a>
      </div>

      <div class="select-boxes">

        <h2>Board Size</h2>

        <h2 >Timer</h2>

      </div>

      <div class="select-boxes">

        <div>


          <select id="boardSizeSelect" class ="select-64">
            <option value=6>6X6</option>
            <option value=7>7x7</option>
            <option value=8 selected>8X8</option>
            <option value=9>9x9</option>
            <option value=10>10x10</option>
            <option value=11>11x11</option>
            <option value=12>12X12</option>
            <option value=13>13x13</option>
            <option value=14>14x14</option>
            <option value=15>15x15</option>
            <option value=16>16x16</option>
    
          </select>

        </div>

        <div>

          
          
          <select id="timerSelect" class="select-64">
            <option value=1000 selected>No Timer</option>
            <option value=5>5 Seconds</option>
            <option value=15>15 Seconds</option>
            <option value=30>30 Seconds</option>
            <option value=45>45 Seconds</option>
            <option value=60>1 Minute</option>
          </select>

        </div>

        

      </div>

      <h2 class="num-players-select-h2">Players</h2>

      <div class="num-players-select">
      
        

        <ul class="num-players">
          
          <li>
            <input type="radio" id="2-player" name="players" checked="checked" value=2 onclick="displayRadioValue()"/>
            <label for="2-player">2</label>
          </li>
          <li>
            <input type="radio" id="3-player" name="players" value=3 onclick="displayRadioValue()"/>
            <label for="3-player">3</label>
          </li>
          <li>
            <input type="radio" id="4-player" name="players" value=4 onclick="displayRadioValue()"/>
            <label for="4-player">4</label>
          </li>
        </ul>
      </div>

      <script>

        function displayRadioValue() {
            var ele = document.getElementsByName('players');
            let numPlayers;
            for(i = 0; i < ele.length; i++) {
                if(ele[i].checked){
                  numPlayers = ele[i].value;
                  // console.log(numPlayers);
                }
                
            }
            let defaultColors = ["#0583D2", "#FF3131", "#50C878", "#ee8329",
                                "#9933ff", "#66ffff", "#ff99ff", "#006600", 
                                "#990000", "#3333ff"]
            let datalist = document.createElement("datalist");
            datalist.setAttribute("id", "presets");
            for(i=0; i<defaultColors.length; i++){
              let option = document.createElement('option');
              option.value = defaultColors[i];
              datalist.appendChild(option);
            }

            

            let currPlayerInputs = document.getElementsByClassName("player-input");
            //console.log(currPlayerInputs.length);
            var div = document.getElementById('all-player-inputs');

            if(numPlayers > currPlayerInputs.length){
              for(i=currPlayerInputs.length+1; i <= numPlayers; i++){
                console.log(i);
                let divInput = document.createElement("div");
                divInput.setAttribute("class", "player-input");

                let textInput = document.createElement("input");
                textInput.setAttribute("class", "player-text");
                let textId = "player-text-"+ (i).toString(10);
                textInput.setAttribute("id", textId);
                textInput.setAttribute("type", "text");
                let length = textInput.value.length;
                textInput.setSelectionRange(length, length);
                let value = "Player"+((i)).toString(10);
                textInput.setAttribute("value", value);

                let colorInput = document.createElement("input");
                colorInput.setAttribute("class", "player-color");
                let colorId = "player-color-"+ (i).toString(10);
                colorInput.setAttribute("id", colorId);
                colorInput.setAttribute("type", "color");
                colorInput.setAttribute("value", defaultColors[i-1]);
                colorInput.setAttribute("list", "presets");

                divInput.appendChild(textInput);
                divInput.appendChild(colorInput);
                divInput.appendChild(datalist);

                div.appendChild(divInput);
              }
            }

            else if(numPlayers < currPlayerInputs.length){
              for(i=0; i<currPlayerInputs.length-numPlayers; i++ ){
                div.removeChild(div.lastChild);
              }
            }
            }

      </script>

      <div class="all-player-inputs" id="all-player-inputs">
        <div class="player-input">
          <input id="player-text-1" class="player-text" type="text" name="player-text" value="Player1">
          <input id="player-color-1" class="player-color" type="color" name="player-color" list="presets" value="#0583D2">
          <datalist id="presets">
            <option value="#0583D2">Blue</option>
            <option value="#FF3131">Red</option>
            <option value="#50C878">Green</option>
            <option value="#ee8329">Orange</option>
            <option value="#9933ff">Purple</option>
            <option value="#66ffff">Ice</option>
            <option value="#ff99ff">Pink</option>
            <option value="#006600">Forest</option>
            <option value="#990000">Dirt</option>
            <option value="#3333ff">Ghost</option>
          </datalist>
        </div>
  
        <div class="player-input">
          <input id="player-text-2" class="player-text" type="text" name="player-text" value="Player2">
          <input id="player-color-2" class="player-color" type="color" name="player-color" list="presets" value="#FF3131">
          <datalist id="presets">
            <option value="#0583D2">Blue</option>
            <option value="#FF3131">Red</option>
            <option value="#50C878">Green</option>
            <option value="#ee8329">Orange</option>
            <option value="#9933ff">Purple</option>
            <option value="#66ffff">Ice</option>
            <option value="#ff99ff">Pink</option>
            <option value="#006600">Forest</option>
            <option value="#990000">Dirt</option>
            <option value="#3333ff">Ghost</option>
          </datalist>
        </div>
      </div>

      
  
      <div class="buttons">
        <a href="game.html">
          <button id="localPlay" onClick="setPlayerInputs()" class = "start-game" type="button" name="Play"> Start </button>
        </a>
      </div>

      <script>

        function darkenColor(color, percent){
          var R = parseInt(color.substring(1,3),16);
          var G = parseInt(color.substring(3,5),16);
          var B = parseInt(color.substring(5,7),16);

          R = parseInt(R * (100 + percent) / 100);
          G = parseInt(G * (100 + percent) / 100);
          B = parseInt(B * (100 + percent) / 100);

          R = (R<255)?R:255;  
          G = (G<255)?G:255;  
          B = (B<255)?B:255;  

          R = Math.round(R / 10) * 10
          G = Math.round(G / 10) * 10
          B = Math.round(B / 10) * 10

          var RR = ((R.toString(16).length==1)?"0"+R.toString(16):R.toString(16));
          var GG = ((G.toString(16).length==1)?"0"+G.toString(16):G.toString(16));
          var BB = ((B.toString(16).length==1)?"0"+B.toString(16):B.toString(16));

          return "#"+RR+GG+BB;
        }

        function setPlayerInputs(){
          let boardSize = document.getElementById("boardSizeSelect").value;
          let timer = document.getElementById("timerSelect").value;
          sessionStorage.setItem("boardSize", boardSize);
          sessionStorage.setItem("timer", timer);
          
          // get num players
          var ele = document.getElementsByName('players');
          let numPlayers;
          for(i = 0; i < ele.length; i++) {
              if(ele[i].checked){
                numPlayers = ele[i].value;
            }
          }

          sessionStorage.setItem("numPlayers", numPlayers);

          // Set player data
          let playerData = [];

          for(i=0; i < numPlayers; i++){
            let textId = "player-text-"+ (i+1).toString(10);
            let colorId = "player-color-"+ (i+1).toString(10);

            let name = document.getElementById(textId).value;
            let color = document.getElementById(colorId).value;
            let outlineColor = darkenColor(color, -30);

            playerData.push([name, [outlineColor, color]]);
          }

          sessionStorage.setItem("playerData", JSON.stringify(playerData));
          
      }
      </script>
                
       
    </div>

  </body>
</html>
